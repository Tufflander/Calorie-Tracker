export const DAY=86400000;export function iso(d=new Date()){return new Date(d.getTime()-d.getTimezoneOffset()*60000).toISOString().slice(0,10)}export function startOfWeek(d=new Date()){const x=new Date(d);const day=(x.getDay()+6)%7;x.setHours(0,0,0,0);x.setDate(x.getDate()-day);return x}export function endOfWeek(d=new Date()){const x=startOfWeek(d);x.setDate(x.getDate()+7);return x}export function ewma(values,alpha=0.25){const out=[];let prev=null;for(const v of values){if(v==null){out.push(prev);continue}prev=prev==null?v:alpha*v+(1-alpha)*prev;out.push(prev)}return out}export function slopePerDay(values){const ys=values.filter(v=>typeof v==='number');if(ys.length<2)return 0;const xs=ys.map((_,i)=>i);const n=ys.length;const sx=xs.reduce((a,b)=>a+b,0);const sy=ys.reduce((a,b)=>a+b,0);const sxy=xs.reduce((a,x,i)=>a+x*ys[i],0);const sxx=xs.reduce((a,x)=>a+x*x,0);const m=(n*sxy-sx*sy)/(n*sxx-sx*sx||1);return m}export function kcalToKJ(kcal){return Math.round(kcal*4.184)}export function sumKcal(foods){return Math.round(foods.reduce((a,f)=>a+(Number(f.kcal)||0),0))}export function sumProtein(foods){return Math.round(foods.reduce((a,f)=>a+(Number(f.proteinG)||0),0))}